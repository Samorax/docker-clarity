 <form clrForm clrLayout="vertical" [formGroup]="settingsForm">
 <section class="clr-row">
  <div>
    <h2>Settings</h2>
  </div>
  

 </section>
 <clr-tabs clrLayout="vertical">
  <clr-tab>
    <button clrTabLink id="accountButton" (click)="fillAccountSettings()">Account</button>

      <clr-tab-content *clrIfActive>
        <section>
          <div>
            <section formGroupName = 'accountDetails'>
              <button (click)="showAccountSettings()" class="btn btn-outline">
                Change Contact Details
              </button>
             
              <div [@openClose]="isOpen ? 'close':'open'">
                <div class="clr-row">
                  <clr-input-container class="clr-col">
                    <label class="clr-control-label clr-required-mark" >First Name</label>
                    <input clrInput formControlName="firstName" required/>
                    <clr-control-error *clrIfError="'required'">This field is required</clr-control-error>
                  </clr-input-container>
                  <clr-input-container class="clr-col">
                    <label class="clr-control-label clr-required-mark" >Last Name</label>
                    <input clrInput formControlName="lastName" required/>
                    <clr-control-error *clrIfError="'required'">This field is required</clr-control-error>
                  </clr-input-container>
                  </div>  
                  <div class="clr-row">              
                    <clr-input-container class="clr-col">
                    <label class="clr-control-label clr-required-mark" >Email</label>
                    <input clrInput formControlName="email"/>
                    <clr-control-error *clrIfError="'required'">This field is required</clr-control-error>
                    <clr-control-error *clrIfError="'email'">This is not an email</clr-control-error>
                  </clr-input-container>
                <clr-input-container class="clr-col">
                  <label class="clr-control-label">Phone Number</label>
                  <input clrInput formControlName="phoneNumber"/>
                  <clr-control-error *clrIfError="'required'">This field is required</clr-control-error>
                </clr-input-container>
                </div>
                <div class="clr-row">
                  <div class="clr-col-3">
                    <button class="btn btn-primary" [disabled]="!settingsForm.get('accountDetails')?.valid" (click)="onChangeAccountDetails()">Save</button>
                  </div>
                  <clr-alert [clrAlertLightweight]="true" [clrAlertType]="'success'" class="clr-col" *ngIf="showAccountDetailsFeedback">
                    <clr-alert-item>
                      <span class="alert-text">Account details Updated!!</span>
                    </clr-alert-item>
                    </clr-alert>
                </div>
              </div>
              
            </section>
  
            <!-- <section formGroupName = 'passwordReset' >
              <div (click)="toggle2()" class="section-header">
                <h6>Change Password</h6>
              </div>
             
              <div [@openClose]="isOpen2 ? 'close':'open'">
                <div class="clr-row">
                  <clr-password-container class="clr-col">
                    <label class="clr-control-label clr-required-mark">New Password</label>
                    <input clrPassword formControlName="oldPassword" required/>
                    <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
                    
                    <clr-control-error *clrIfError="'pattern'">
                      Password must fuifill the following:
                      <ul>
                        <li>must include both uppercase and lowercase alphabets</li>
                        <li>must include at least a number</li>
                        <li>must include at least one of these symbols: &#64;$!%*?&</li>
                        <li>must be at least 8 characters</li>
                      </ul>
                    </clr-control-error>
                    
                  </clr-password-container>
                  <clr-password-container class="clr-col">
                    <label class="clr-control-label clr-required-mark">Verify Password</label>
                    <input clrPassword formControlName="newPassword" required/>
                    <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
                    <clr-control-error *clrIfError="'mustMatch'">Password Mismatch!!</clr-control-error>
                    <clr-control-error *clrIfError="'pattern'">
                      Password must fuifill the following:
                      <ul>
                        <li>must include both uppercase and lowercase alphabets</li>
                        <li>must include at least a number</li>
                        <li>must include at least one of these symbols: &#64;$!%*?&</li>
                        <li>must be at least 8 characters</li>
                      </ul>
                    </clr-control-error>
                  </clr-password-container>
                </div>
                <div class="clr-row">
                  <div class="clr-col-3">
                    <button class="btn btn-primary" [disabled]="!settingsForm.get('passwordReset')?.valid" (click)="onChangePassword()">Save</button>
                  </div>
                  <clr-alert [clrAlertLightweight]="true" [clrAlertType]="'success'" class="clr-col" *ngIf="showChangePasswordFeedback">
                  <clr-alert-item>
                    <span class="alert-text">Password Updated!!</span>
                  </clr-alert-item>
                  </clr-alert>
                </div>
                
              </div>
              
            </section> -->
            
          </div>
         
        </section>
        <section>
          <div>
            <button (click)="showPaymentDetailsSettings()" class="btn btn-outline">Change Payment Details</button>
            <div class="formbody" id="payment-form" [@openClose]="isOpen3 ? 'close':'open'">
              <div class="group" id="payment-element">
                <!--Stripe.js injects the Payment Element-->
              </div>
              <div class="clr-row">
                <div class="clr-col-3">
                  <button id="button-text" class="btn btn-primary" #button (click)="onChangePaymentDetails($event)">
                    <!-- <div class="spinner hidden" id="spinner"></div> -->
                    <span id="button-text">Save</span>
                  </button>
                </div>
                <clr-alert [clrAlertLightweight]="true" [clrAlertType]="'success'" class="clr-col" *ngIf="showPaymentUpdateFeedback">
                  <clr-alert-item>
                    <span class="alert-text">Payment details Updated!!</span>
                  </clr-alert-item>
                  </clr-alert>
                  <div id="payment-message" class="hidden"></div>
              </div>
              
            </div>
          </div>
        </section>
        <section>
          <button class="btn btn-danger" (click)="onAccountDelete($event)">Delete Account</button>
        </section>   
      </clr-tab-content>
    
    
  </clr-tab>
  <clr-tab>
    <button clrTabLink (click)="fillIntegrationSettings()">Integrations</button>
    <clr-tab-content *clrIfActive>
      <section formGroupName="integrationSettings">
        <button (click)="showPaymentProcessorSettings()" class="btn btn-outline">Change Payment Processor</button>
        <div [@openClose]="isOpen4 ?'close':'open'">
          <clr-select-container>
            <label class="clr-required-mark clr-control-label">Select Payment Provider</label>
            <select clrSelect formControlName="Name" #selection (change)="onChangeProcessor()">
                <option value="Dojo">Dojo</option>
            </select>
          </clr-select-container>
        <div *ngIf="showDojoForms" class="clr-row">
          <div class="clr-col">
            <clr-password-container>
              <label class="clr-required-mark">Api Key</label>
              <input clrPassword autocomplete="current-password" placeholder="Api Key please!" formControlName="ApiKey1"/>
              <clr-control-error *clrIfError="'required'">This field is required</clr-control-error>
            </clr-password-container>
            <clr-password-container>
              <label class="clr-required-mark">Account Id</label>
              <input clrPassword autocomplete="current-password" placeholder="Insert account id" formControlName="AccountId" />
              <clr-control-error *clrIfError="'required'">This field is required</clr-control-error>
            </clr-password-container>
          </div>
        <div class="clr-col">
          <clr-password-container>
            <label class="clr-required-mark">Software House Id</label>
            <input clrPassword autocomplete="current-password" placeholder="Insert softwareHouseId" formControlName="SoftwareHouseId" />
            <clr-control-error *clrIfError="'required'">This field is required</clr-control-error>
          </clr-password-container>
        </div>
          
        </div>
        <div class="clr-row">
          <div class="clr-col-3">
            <button class="btn btn-primary" (click)="onChangePaymentProcessor($event)" [disabled]="!settingsForm.get('integrationSettings')?.valid" [clrLoading]="PaymentBtnState">Save</button>
          </div>
          <div class="clr-col">
            <clr-alert [clrAlertLightweight]="true" [clrAlertType]="'success'" class="clr-col" *ngIf="showPaymentProcessorUpdateFeedback">
              <clr-alert-item>
                <span class="alert-text">Payment Processor Updated!!</span>
              </clr-alert-item>
              </clr-alert>
          </div>
        </div>
        </div>
      </section>
      <section formGroupName="accountingSettings">
        <div>
          <button class="btn btn-outline" (click)="showAccountSystemSettings()">Change Accounting System</button>
          <div [@openClose]="isOpen9?'close':'open'">
            <clr-select-container>
              <label class="clr-required-mark clr-control-label">Select Accounting System</label>
              <select clrSelect formControlName="accountingSystem" #selectedSystem (change)="onChangeAccountingSystem(selectedSystem.value)">
                  <option value="Xero">Xero</option>
              </select>
            </clr-select-container>
              <div *ngIf="showXeroForms">
                <div class="clr-row">
                  <div class="clr-col">
                    <clr-password-container>
                      <label class="clr-required-mark">Client ID</label>
                      <input clrPassword autocomplete="current-password" placeholder="insert client id" formControlName="clientId"/>
                      <clr-control-error *clrIfError="'required'">This field is required</clr-control-error>
                    </clr-password-container>
                  </div>
                  <div class="clr-col">
                    <clr-password-container>
                      <label class="clr-required-mark">Client Secret</label>
                      <input clrPassword autocomplete="current-password" placeholder="Insert client secret" formControlName="clientSecret" />
                      <clr-control-error *clrIfError="'required'">This field is required</clr-control-error>
                    </clr-password-container>
                  </div>
                </div>
                <button class="btn btn-primary" (click)="onSaveAccountingSystem($event)" [disabled]="!settingsForm.get('accountingSettings')?.valid">Save</button>
              </div>
          </div>
        </div>
          
      </section>
    </clr-tab-content>
  </clr-tab>

  <clr-tab>
    <button clrTabLink (click)="fillNotificationSettings()">Notifications</button>
    <clr-tab-content>
      <section formGroupName="notifications">
        <div>
          <h4>SMS Notifications</h4>
          <clr-toggle-container>
            <clr-checkbox-wrapper>
              <input type="checkbox" clrToggle  formControlName="smsActivation" (change)="onSmsActivation()"/>
              <label>SMS Activation</label>
            </clr-checkbox-wrapper>
            <clr-control-helper>Usage costs {{0.042| currency}} per SMS</clr-control-helper>
          </clr-toggle-container>
        </div>
        <div>
          <h4>Birthday Notifications</h4>
          <clr-toggle-container>
            <clr-toggle-wrapper>
              <input type="checkbox" clrToggle  formControlName="birthdayNotifications" (change)="onBirthdayNotifications()"/>
              <label>Notifications Activation</label>
            </clr-toggle-wrapper>
            <clr-control-helper>You will be reminded a week before customer's Birthday. It is free.</clr-control-helper>
          </clr-toggle-container>
        </div>
        <div>
          <h4>Voucher Notifications</h4>
          <clr-toggle-container>
            <clr-toggle-wrapper>
              <input type="checkbox" clrToggle  formControlName="voucherNotifications" (change)="onVoucherNotifications()"/>
              <label>Notifications Activation</label>
            </clr-toggle-wrapper>
            <clr-control-helper>You will be reminded of voucher usage limits. It is free</clr-control-helper>
          </clr-toggle-container>
        </div>
       
      </section>
    </clr-tab-content>
  </clr-tab>

  <clr-tab>
    <button clrTabLink (click)="fillShopSettings()">Shop Operations</button>
    <clr-tab-content *clrIfActive>
      <section formGroupName="operatingHours">
        
          <h4>Operating Hours Settings</h4>
         <button (click)="toggle5()" class="btn btn-outline">
          Change Operating Hours
         </button>
            <div class="clr-row" [@openClose]="isOpen5 ?'close':'open'">
              <div class="clr-col">

                <clr-datagrid [(clrDgSelected)]="selected">
                  <clr-dg-action-bar>
                    <div class="btn-group">
                      <button type="button" class="btn btn-sm btn-secondary" (click)="onAdd()">
                        <cds-icon shape="plus"></cds-icon>
                        Add to group
                      </button>
                      <button type="button" class="btn btn-sm btn-secondary" (click)="onDelete()">
                        <cds-icon shape="close"></cds-icon>
                        Delete
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-secondary"
                        (click)="onEdit()"
                        *ngIf="selected.length == 1"
                      >
                        <cds-icon shape="pencil"></cds-icon>
                        Edit
                      </button>
                    </div>
                  </clr-dg-action-bar>                
                  <clr-dg-column>Day</clr-dg-column>
                  <clr-dg-column>Start Time</clr-dg-column>
                  <clr-dg-column>Closing Time</clr-dg-column>
                    <clr-dg-row *clrDgItems="let o of openingTimes" [clrDgItem]="o">
                    <clr-dg-cell>{{ o.day}}</clr-dg-cell>
                    <clr-dg-cell>{{ o.startTime }}</clr-dg-cell>
                    <clr-dg-cell>{{ o.endTime}}</clr-dg-cell>
                  </clr-dg-row>
                </clr-datagrid>
  
                
              </div>
           </div>
            
            
          
            
        
        
      </section>

      <section formGroupName="logistics">
        <button (click)="showLogisticsSettings()" class="btn btn-outline">
          Change logistics
        </button>
       
        <div class="clr-row" [@openClose]="isOpen6 ?'close':'open'">
          <clr-input-container class="clr-col">
            <label class="clr-control-label clr-required-mark">Delivery Distance (miles)</label>
            <input clrInput formControlName="deliveryDistance"/>
            <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
          </clr-input-container>
          <clr-input-container class="clr-col">
            <label class="clr-control-label clr-required-mark">Delivery Fee ({{0 | currency}}):</label>
            <input clrInput placeholder="3" formControlName="deliveryFee" />
            <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
          </clr-input-container>
          <div class="clr-row">
            <div class="clr-col-3">
              <button class="btn btn-primary" (click)="onChangeLogisticsDetails()" [disabled]="!settingsForm.get('logistics')?.valid">Save</button>
            </div>
            <div class="clr-col">
              <clr-alert [clrAlertLightweight]="true" [clrAlertType]="'success'" class="clr-col" *ngIf="showLogisticsUpdateFeedback">
                <clr-alert-item>
                  <span class="alert-text">Logistics Updated!!</span>
                </clr-alert-item>
                </clr-alert>
            </div>
          </div>
          
        </div>
        
      </section>
     
      <section formGroupName="shopSettings">
        <button (click)="showReceiptSettings()" class="btn btn-outline">
          Change receipts
        </button>
        
        <div class="clr-row" [@openClose]="isOpen7 ?'close':'open'">
          <clr-input-container class="clr-col">
            <label class="clr-control-label clr-required-mark">VAT Rate (%):</label>
            <input clrInput  formControlName="vatCharge" />
            <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
          </clr-input-container>
          <clr-input-container class="clr-col">
            <label class="clr-control-label clr-required-mark">Service Charge (%):</label>
            <input clrInput formControlName="serviceCharge" />
            <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
          </clr-input-container>
          <div class="clr-row">
            <div class="clr-col-3">
              <button class="btn btn-primary" (click)="onChangeReceiptDetails()" [disabled]="!settingsForm.get('shopSettings')?.valid"  [clrLoading]="ReceiptBtnState">Save</button>
            </div>
            <div class="clr-col">
              <clr-alert [clrAlertLightweight]="true" [clrAlertType]="'success'" class="clr-col" *ngIf="showReceiptUpdateFeedback">
                <clr-alert-item>
                  <span class="alert-text">Receipts Updated!!</span>
                </clr-alert-item>
                </clr-alert>
            </div>
          </div>
        </div>
        
      </section>
      
      <section formGroupName="businessDetails">
        <button (click)="showAddressSettings()" class="btn btn-outline">
          Change Address
        </button>
        <div [@openClose]="isOpen8 ? 'close':'open'">
          <div class="clr-row" >
            <clr-input-container class="clr-col">
              <label class="clr-control-label clr-required-mark">Address Line 1</label>
              <input clrInput formControlName="businessAddressLine1" />
              <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
            </clr-input-container>
            <clr-input-container class="clr-col">
              <label class="clr-control-label ">Address Line 2</label>
              <input clrInput formControlName="businessAddressLine2"/>
            </clr-input-container>
          </div>
          <div class="clr-row">
            <clr-input-container class="clr-col">
              <label class="clr-control-label clr-required-mark">City</label>
              <input clrInput formControlName="city"/>
              <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
            </clr-input-container>
            <clr-input-container class="clr-col">
              <label class="clr-control-label clr-required-mark">Postal Code</label>
              <input clrInput formControlName="postalCode"/>
              <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
            </clr-input-container>
          </div>
         <div class="clr-row">
          <clr-input-container class="clr-col">
            <label class="clr-control-label clr-required-mark">Country</label>
            <input clrInput formControlName="country"/>
            <clr-control-error *clrIfError="'required'">This field is required!!</clr-control-error>
          </clr-input-container>
          </div>
          <div class="clr-row">
            <div class="clr-col-3">
              <button class="btn btn-primary" (click)="onChangeBusinessDetails()" [disabled]="!settingsForm.get('businessDetails')?.valid">Save</button>
            </div>
            <div class="clr-col">
              <clr-alert [clrAlertLightweight]="true" [clrAlertType]="'success'" class="clr-col" *ngIf="showBusinessDetailsUpdateFeedback">
                <clr-alert-item>
                  <span class="alert-text">Address Updated!!</span>
                </clr-alert-item>
                </clr-alert>
            </div>
          </div>
        
        </div>
       
      </section>
    </clr-tab-content>
  </clr-tab>

  <clr-tab>
    <button clrTabLink>Developer</button>
    <clr-tab-content>
      <section class="clr-row">
        <clr-spinner *ngIf="SwitchMode">Processing</clr-spinner>
        <clr-toggle-container class="clr-toggle-right clr-col">
          <clr-toggle-wrapper>
            <input type="checkbox" clrToggle #switch  formControlName="testMode" (change)="onSwitchMode()" />
            <label>Test Mode</label>
          </clr-toggle-wrapper>
          <clr-control-helper>Switch it off when you want to start selling</clr-control-helper>
        </clr-toggle-container>
        <div class="clr-col">
          <button class="btn btn-link" (click)="onApiRequest($event)">Get Api Key</button>
            <span *ngIf="showKey" class="label">{{apiKey}}</span>
        </div>
      </section>
    </clr-tab-content>
  </clr-tab>
</clr-tabs>
 </form>
 <app-operatingdays></app-operatingdays>
 <app-editoperatingdays></app-editoperatingdays>
 <app-deloperatingdays></app-deloperatingdays>
 <app-deleteaccount></app-deleteaccount>